0001: <!DOCTYPE html>
0002: <html lang="uk">
0003: <head>
0004:     <meta charset="UTF-8">
0005:     <meta name="viewport" content="width=device-width, initial-scale=1.0">
0006:     <title>Статистика тренувань - Maria Training</title>
0007:     <link rel="stylesheet" href="styles.css">
0008:     <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
0009:     <style>
0010:         :root {
0011:             --stress-color: #FFD700;
0012:             --hardness-color: #FF0000;
0013:             --sleep-color: #9370DB;
0014:             --feelings-color: #00FF00;
0015:             --weight-color: #00BFFF;
0016:             --background-color: #E6E9F0;
0017:             --card-background: #FFFFFF;
0018:             --card-shadow: 0 4px 12px rgba(0,0,0,0.1);
0019:             --border-radius: 20px;
0020:         }
0021:         
0022:         body {
0023:             font-family: 'Arial', sans-serif;
0024:             background-color: var(--background-color);
0025:             margin: 0;
0026:             padding: 20px;
0027:         }
0028:         
0029:         .container {
0030:             max-width: 1200px;
0031:             margin: 0 auto;
0032:             padding: 20px;
0033:         }
0034:         
0035:         .summary-box {
0036:             background-color: var(--card-background);
0037:             border-radius: var(--border-radius);
0038:             padding: 20px;
0039:             margin-bottom: 30px;
0040:             box-shadow: var(--card-shadow);
0041:             display: flex;
0042:             justify-content: space-around;
0043:         }
0044:         
0045:         .metric {
0046:             text-align: center;
0047:             padding: 10px 20px;
0048:         }
0049:         
0050:         .metric-value {
0051:             font-size: 28px;
0052:             font-weight: bold;
0053:         }
0054:         
0055:         .metric-label {
0056:             font-size: 14px;
0057:             color: #666;
0058:             margin-top: 5px;
0059:         }
0060:         
0061:         .stats-grid {
0062:             display: grid;
0063:             grid-template-columns: repeat(2, 1fr);
0064:             grid-template-rows: auto auto auto;
0065:             gap: 25px;
0066:         }
0067:         
0068:         .stats-card {
0069:             background-color: var(--card-background);
0070:             border-radius: var(--border-radius);
0071:             overflow: hidden;
0072:             box-shadow: var(--card-shadow);
0073:             display: flex;
0074:             flex-direction: column;
0075:             aspect-ratio: 1 / 1;
0076:         }
0077:         
0078:         .stats-card.wide {
0079:             grid-column: span 2;
0080:             aspect-ratio: 2 / 1;
0081:         }
0082:         
0083:         .card-header {
0084:             padding: 12px;
0085:             text-align: center;
0086:             color: white;
0087:             font-weight: bold;
0088:             border-radius: 30px;
0089:             margin: 15px auto 5px;
0090:             width: 80%;
0091:             max-width: 200px;
0092:         }
0093:         
0094:         .card-header h2 {
0095:             margin: 0;
0096:             font-size: 18px;
0097:             text-transform: uppercase;
0098:             letter-spacing: 1px;
0099:         }
0100:         
0101:         .card-body {
0102:             padding: 15px;
0103:             flex-grow: 1;
0104:             display: flex;
0105:             align-items: center;
0106:             justify-content: center;
0107:         }
0108:         
0109:         .chart-container {
0110:             width: 100%;
0111:             height: 100%;
0112:             position: relative;
0113:             padding: 10px;
0114:             box-sizing: border-box;
0115:         }
0116:         
0117:         /* Card header colors */
0118:         /* .stress {
0119:             background-color: var(--stress-color);
0120:         }
0121:         
0122:         .hardness {
0123:             background-color: var(--hardness-color);
0124:         }
0125:         
0126:         .sleep {
0127:             background-color: var(--sleep-color);
0128:         }
0129:         
0130:         .feelings {
0131:             background-color: var(--feelings-color);
0132:         }
0133:         
0134:         .weight {
0135:             background-color: var(--weight-color);
0136:         } */
0137:         
0138:         /* Export button styles */
0139:         .export-container {
0140:             text-align: center;
0141:             margin: 20px 0;
0142:         }
0143:         
0144:         .export-button {
0145:             background-color: #4CAF50;
0146:             color: white;
0147:             border: none;
0148:             padding: 12px 24px;
0149:             font-size: 16px;
0150:             border-radius: 30px;
0151:             cursor: pointer;
0152:             box-shadow: 0 4px 8px rgba(0,0,0,0.2);
0153:             transition: all 0.3s ease;
0154:         }
0155:         
0156:         .export-button:hover {
0157:             background-color: #45a049;
0158:             transform: translateY(-2px);
0159:             box-shadow: 0 6px 12px rgba(0,0,0,0.2);
0160:         }
0161:         
0162:         /* Mobile styles */
0163:         @media (max-width: 768px) {
0164:             .stats-grid {
0165:                 grid-template-columns: 1fr;
0166:             }
0167:             
0168:             .stats-card.wide {
0169:                 grid-column: auto;
0170:                 aspect-ratio: 1 / 1;
0171:             }
0172:             
0173:             .summary-box {
0174:                 flex-direction: column;
0175:             }
0176:         }
0177:     </style>
0178: </head>
0179: <body>
0180:     <div class="container">
0181:         
0182:         <div class="stats-grid" id="statsGrid">
0183:             <!-- Стрес -->
0184:             <div class="stats-card">
0185:                 <div class="card-header stress">
0186:                     <h2>СТРЕС</h2>
0187:                 </div>
0188:                 <div class="card-body">
0189:                     <div class="chart-container">
0190:                         <canvas id="stressChart"></canvas>
0191:                     </div>
0192:                 </div>
0193:             </div>
0194: 
0195:             <!-- Складність -->
0196:             <div class="stats-card">
0197:                 <div class="card-header hardness">
0198:                     <h2>СКЛАДНІСТЬ</h2>
0199:                 </div>
0200:                 <div class="card-body">
0201:                     <div class="chart-container">
0202:                         <canvas id="hardnessChart"></canvas>
0203:                     </div>
0204:                 </div>
0205:             </div>
0206: 
0207:             <!-- Сон -->
0208:             <div class="stats-card">
0209:                 <div class="card-header sleep">
0210:                     <h2>СОН</h2>
0211:                 </div>
0212:                 <div class="card-body">
0213:                     <div class="chart-container">
0214:                         <canvas id="sleepChart"></canvas>
0215:                     </div>
0216:                 </div>
0217:             </div>
0218: 
0219:             <!-- Самопочуття -->
0220:             <div class="stats-card">
0221:                 <div class="card-header feelings">
0222:                     <h2>САМОПОЧУТТЯ</h2>
0223:                 </div>
0224:                 <div class="card-body">
0225:                     <div class="chart-container">
0226:                         <canvas id="feelingsChart"></canvas>
0227:                     </div>
0228:                 </div>
0229:             </div>
0230:             
0231:             <!-- Вага -->
0232:             <div class="stats-card wide">
0233:                 <div class="card-header weight">
0234:                     <h2>ВАГА</h2>
0235:                 </div>
0236:                 <div class="card-body">
0237:                     <div class="chart-container">
0238:                         <canvas id="weightChart"></canvas>
0239:                     </div>
0240:                 </div>
0241:             </div>
0242:         </div>
0243:     </div>
0244: 
0245:     <script>
0246:         // Data from Python
0247:         const sampleData = {"dates": ["31.03", "30.03", "29.03", "28.03", "27.03", "26.03", "25.03", "24.03", "22.03", "21.03", "20.03", "19.03", "17.04", "16.04", "14.04", "12.04", "11.04", "09.04", "08.04", "07.04", "06.04", "05.04", "04.04", "03.04", "02.04"], "stress": {"values": [null, null, 4, null, null, 4, null, null, 5, null, null, 5, null, 4, 7, 5, null, 5, null, 3, null, 7, null, null, 7], "color": "#FFD700"}, "hardness": {"values": [null, null, 8, null, null, 5, null, null, 9, null, null, 7, 4, 6, 9, 8, null, 8, null, 7, null, 8, null, null, 9], "color": "#FF0000", "soreness": [false, false, true, false, false, true, false, false, false, false, false, true, false, true, false, false, false, true, false, false, false, true, false, false, true]}, "sleep": {"values": [8.066666666666666, 6.683333333333334, 7.433333333333334, 6.35, 7.083333333333333, 8.45, 7.283333333333333, 8.283333333333333, 8.433333333333334, 6.566666666666666, 6.733333333333333, null, 8.083333333333334, 8.616666666666667, 6.45, 8.366666666666667, 8.966666666666667, 7.6, 8.083333333333334, 8.0, 8.266666666666667, 7.333333333333333, 8.8, 7.25, 8.666666666666666], "color": "#9370DB"}, "feelings": {"values": [5, 6, 5, 8, 8, 7, 5, 4, 5, 7, 6, null, 6, 5, 5, 6, 8, 4, 9, 6, 6, 4, 6, 6, 6], "color": "#00FF00"}};
0248:         
0249:         // Debug information
0250:         console.log("Chart data loaded:", sampleData);
0251:         
0252:         // Set default Chart.js options
0253:         Chart.defaults.font.family = "'Arial', sans-serif";
0254:         Chart.defaults.font.size = 14;
0255:         Chart.defaults.font.weight = 'bold';
0256:         Chart.defaults.color = '#000000';
0257:         Chart.defaults.plugins.tooltip = {
0258:             backgroundColor: 'rgba(0,0,0,0.8)',
0259:             titleFont: {
0260:                 size: 16,
0261:                 weight: 'bold'
0262:             },
0263:             bodyFont: {
0264:                 size: 14,
0265:                 weight: 'bold'
0266:             },
0267:             padding: 10,
0268:             cornerRadius: 5,
0269:             displayColors: false,
0270:             titleColor: '#FFFFFF',
0271:             bodyColor: '#FFFFFF'
0272:         };
0273:         
0274:         // Common chart options
0275:         const commonOptions = {
0276:             responsive: true,
0277:             maintainAspectRatio: false,
0278:             plugins: {
0279:                 legend: {
0280:                     display: false
0281:                 },
0282:                 tooltip: {
0283:                     enabled: true,
0284:                     backgroundColor: 'rgba(0,0,0,0.8)',
0285:                     titleFont: {
0286:                         size: 16,
0287:                         weight: 'bold'
0288:                     },
0289:                     bodyFont: {
0290:                         size: 14,
0291:                         weight: 'bold'
0292:                     },
0293:                     padding: 10,
0294:                     cornerRadius: 5,
0295:                     displayColors: false,
0296:                     titleColor: '#FFFFFF',
0297:                     bodyColor: '#FFFFFF'
0298:                 }
0299:             },
0300:             layout: {
0301:                 padding: {
0302:                     left: 20,
0303:                     right: 20,
0304:                     top: 20,
0305:                     bottom: 20
0306:                 }
0307:             },
0308:             scales: {
0309:                 x: {
0310:                     grid: {
0311:                         display: true,
0312:                         color: 'rgba(200, 200, 200, 0.15)',
0313:                         borderDash: [5, 5],
0314:                         drawBorder: false
0315:                     },
0316:                     ticks: {
0317:                         font: {
0318:                             size: 10
0319:                         },
0320:                         color: '#888',
0321:                         maxRotation: 0,
0322:                         padding: 5
0323:                     }
0324:                 },
0325:                 y: {
0326:                     beginAtZero: true,
0327:                     grid: {
0328:                         display: true,
0329:                         color: 'rgba(200, 200, 200, 0.15)',
0330:                         borderDash: [5, 5],
0331:                         drawBorder: false
0332:                     },
0333:                     ticks: {
0334:                         font: {
0335:                             size: 10
0336:                         },
0337:                         color: '#888',
0338:                         padding: 5,
0339:                         stepSize: 1
0340:                     }
0341:                 }
0342:             },
0343:             elements: {
0344:                 point: {
0345:                     radius: 6,
0346:                     hoverRadius: 8,
0347:                     borderWidth: 0
0348:                 },
0349:                 line: {
0350:                     tension: 0.4,
0351:                     borderWidth: 3
0352:                 },
0353:                 bar: {
0354:                     borderWidth: 0,
0355:                     borderRadius: 4
0356:                 }
0357:             }
0358:         };
0359: 
0360:         // Function to display "No data" message in center of chart
0361:         function displayNoDataMessage(chart, datasetLabel) {
0362:             const ctx = chart.ctx;
0363:             const width = chart.width;
0364:             const height = chart.height;
0365:             
0366:             chart.clear();
0367:             
0368:             ctx.save();
0369:             ctx.textAlign = 'center';
0370:             ctx.textBaseline = 'middle';
0371:             ctx.font = 'bold 16px Arial';
0372:             ctx.fillStyle = '#666';
0373:             ctx.fillText(`Немає даних про ${datasetLabel}`, width / 2, height / 2);
0374:             ctx.restore();
0375:         }
0376: 
0377:         // Function to create a chart with no data handling
0378:         function createChart(ctx, config, datasetLabel) {
0379:             const chart = new Chart(ctx, config);
0380:             
0381:             // Check if there's no data
0382:             if (!config.data.datasets[0].data.length) {
0383:                 displayNoDataMessage(chart, datasetLabel);
0384:             }
0385:             
0386:             return chart;
0387:         }
0388: 
0389:         // Create stress chart (line chart with yellow line)
0390:         const stressCtx = document.getElementById('stressChart').getContext('2d');
0391:         console.log("Creating stress chart with data:", sampleData.dates, sampleData.stress.values);
0392:         
0393:         // Create gradient for stress chart background
0394:         const stressGradient = stressCtx.createLinearGradient(0, 0, 0, 300);
0395:         stressGradient.addColorStop(0, 'rgba(255, 215, 0, 0.1)');
0396:         stressGradient.addColorStop(1, 'rgba(255, 215, 0, 0.0)');
0397:         
0398:         const stressConfig = {
0399:             type: 'line',
0400:             data: {
0401:                 labels: sampleData.dates,
0402:                 datasets: [{
0403:                     data: sampleData.stress.values,
0404:                     borderColor: '#FFD700', // Yellow
0405:                     backgroundColor: stressGradient,
0406:                     borderWidth: 3,
0407:                     pointBackgroundColor: '#FFD700',
0408:                     pointBorderColor: '#FFD700',
0409:                     pointHoverBackgroundColor: '#FFD700',
0410:                     pointHoverBorderColor: '#FFD700',
0411:                     tension: 0.4,
0412:                     fill: true,
0413:                     spanGaps: true
0414:                 }]
0415:             },
0416:             options: {
0417:                 ...commonOptions,
0418:                 scales: {
0419:                     ...commonOptions.scales,
0420:                     y: {
0421:                         ...commonOptions.scales.y,
0422:                         min: 0,
0423:                         max: 10.5,
0424:                         ticks: {
0425:                             ...commonOptions.scales.y.ticks,
0426:                             stepSize: 2,
0427:                             color: '#000000',
0428:                             font: {
0429:                                 weight: 'bold'
0430:                             },
0431:                             callback: function(value) {
0432:                                 return value <= 10 ? value : '';
0433:                             }
0434:                         },
0435:                         title: {
0436:                             display: false,
0437:                             text: 'Рівень стресу (1-10)',
0438:                             color: '#000000',
0439:                             font: {
0440:                                 weight: 'bold',
0441:                                 size: 14
0442:                             }
0443:                         },
0444:                         grid: {
0445:                             color: 'rgba(0, 0, 0, 0.1)'
0446:                         }
0447:                     },
0448:                     x: {
0449:                         grid: {
0450:                             display: false
0451:                         },
0452:                         ticks: {
0453:                             color: '#000000',
0454:                             font: {
0455:                                 weight: 'bold'
0456:                             }
0457:                         }
0458:                     }
0459:                 }
0460:             }
0461:         };
0462:         const stressChart = createChart(stressCtx, stressConfig, 'рівень стресу');
0463: 
0464:         // Create hardness chart with gradient
0465:         const hardnessCtx = document.getElementById('hardnessChart').getContext('2d');
0466:         console.log("Creating hardness chart with data:", sampleData.dates, sampleData.hardness.values);
0467:         
0468:         // Create gradient for hardness chart
0469:         const hardnessGradient = hardnessCtx.createLinearGradient(0, 0, 0, 300);
0470:         hardnessGradient.addColorStop(0, 'rgba(255, 0, 0, 0.3)');
0471:         hardnessGradient.addColorStop(1, 'rgba(255, 0, 0, 0.0)');
0472:         
0473:         const hardnessConfig = {
0474:             type: 'line',
0475:             data: {
0476:                 labels: sampleData.dates,
0477:                 datasets: [{
0478:                     data: sampleData.hardness.values,
0479:                     borderColor: '#FF0000', // Red
0480:                     backgroundColor: hardnessGradient,
0481:                     borderWidth: 3,
0482:                     pointBackgroundColor: '#FF0000',
0483:                     pointBorderColor: '#FF0000',
0484:                     pointHoverBackgroundColor: '#FF0000',
0485:                     pointHoverBorderColor: '#FF0000',
0486:                     tension: 0.4,
0487:                     fill: true,
0488:                     spanGaps: true
0489:                 }]
0490:             },
0491:             options: {
0492:                 ...commonOptions,
0493:                 scales: {
0494:                     ...commonOptions.scales,
0495:                     y: {
0496:                         ...commonOptions.scales.y,
0497:                         min: 0,
0498:                         max: 10.5,
0499:                         ticks: {
0500:                             ...commonOptions.scales.y.ticks,
0501:                             stepSize: 2,
0502:                             color: '#000000',
0503:                             font: {
0504:                                 weight: 'bold'
0505:                             },
0506:                             callback: function(value) {
0507:                                 return value <= 10 ? value : '';
0508:                             }
0509:                         },
0510:                         title: {
0511:                             display: false,
0512:                             text: 'Складність (1-10)',
0513:                             color: '#000000',
0514:                             font: {
0515:                                 weight: 'bold',
0516:                                 size: 14
0517:                             }
0518:                         },
0519:                         grid: {
0520:                             color: 'rgba(0, 0, 0, 0.1)'
0521:                         }
0522:                     },
0523:                     x: {
0524:                         grid: {
0525:                             display: false
0526:                         },
0527:                         ticks: {
0528:                             color: '#000000',
0529:                             font: {
0530:                                 weight: 'bold'
0531:                             }
0532:                         }
0533:                     }
0534:                 }
0535:             }
0536:         };
0537:         const hardnessChart = createChart(hardnessCtx, hardnessConfig, 'складність тренувань');
0538: 
0539:         // Custom plugin to draw the sleep bars with rounded corners and proper styling
0540:         const sleepBarsPlugin = {
0541:             id: 'sleepBars',
0542:             beforeDraw: (chart) => {
0543:                 const {ctx, chartArea, scales} = chart;
0544:                 const {top, bottom, left, width} = chartArea;
0545:                 const barCount = sampleData.dates.length;
0546:                 const barWidth = width / barCount * 0.5; // Thinner bars
0547:                 const barOffset = width / barCount * 0.25; // Center the bars
0548:                 
0549:                 // Clear the canvas first
0550:                 ctx.save();
0551:                 ctx.globalCompositeOperation = 'destination-out';
0552:                 ctx.fillRect(left, top, width, bottom - top);
0553:                 ctx.restore();
0554:                 
0555:                 // Draw bars with rounded tops
0556:                 for (let i = 0; i < barCount; i++) {
0557:                     if (sampleData.sleep.values[i] === null) continue;
0558:                     
0559:                     const x = left + (width / barCount) * i + barOffset;
0560:                     const value = sampleData.sleep.values[i];
0561:                     const maxValue = 10; // Max value for scaling
0562:                     const barHeight = (bottom - top) * (value / maxValue); // Scale to max value
0563:                     
0564:                     // Draw background bar (full height, light color)
0565:                     ctx.fillStyle = 'rgba(147, 112, 219, 0.2)';
0566:                     ctx.beginPath();
0567:                     ctx.roundRect(x, top, barWidth, bottom - top, [4, 4, 0, 0]);
0568:                     ctx.fill();
0569:                     
0570:                     // Draw the actual value bar
0571:                     ctx.fillStyle = '#9370DB'; // Purple for the actual bar
0572:                     ctx.beginPath();
0573:                     ctx.roundRect(x, bottom - barHeight, barWidth, barHeight, [4, 4, 0, 0]);
0574:                     ctx.fill();
0575:                 }
0576:             }
0577:         };
0578: 
0579:         // Create sleep chart (bar chart)
0580:         const sleepCtx = document.getElementById('sleepChart').getContext('2d');
0581:         console.log("Creating sleep chart with data:", sampleData.dates, sampleData.sleep.values);
0582:         const sleepConfig = {
0583:             type: 'bar', // Using bar type but we'll override the drawing
0584:             data: {
0585:                 labels: sampleData.dates,
0586:                 datasets: [{
0587:                     data: sampleData.sleep.values,
0588:                     backgroundColor: 'rgba(0,0,0,0)', // Transparent, we'll draw custom bars
0589:                     borderColor: 'rgba(0,0,0,0)',
0590:                     borderWidth: 0
0591:                 }]
0592:             },
0593:             options: {
0594:                 ...commonOptions,
0595:                 scales: {
0596:                     ...commonOptions.scales,
0597:                     y: {
0598:                         ...commonOptions.scales.y,
0599:                         min: 0,
0600:                         max: 12,
0601:                         ticks: {
0602:                             ...commonOptions.scales.y.ticks,
0603:                             stepSize: 2,
0604:                             color: '#000000',
0605:                             font: {
0606:                                 weight: 'bold'
0607:                             }
0608:                         },
0609:                         title: {
0610:                             display: false,
0611:                             text: 'Години',
0612:                             color: '#000000',
0613:                             font: {
0614:                                 weight: 'bold',
0615:                                 size: 14
0616:                             }
0617:                         },
0618:                         grid: {
0619:                             color: 'rgba(0, 0, 0, 0.1)'
0620:                         }
0621:                     },
0622:                     x: {
0623:                         grid: {
0624:                             display: false
0625:                         },
0626:                         ticks: {
0627:                             color: '#000000',
0628:                             font: {
0629:                                 weight: 'bold'
0630:                             }
0631:                         }
0632:                     }
0633:                 }
0634:             },
0635:             plugins: [sleepBarsPlugin]
0636:         };
0637:         const sleepChart = createChart(sleepCtx, sleepConfig, 'години сну');
0638: 
0639:         // Create feelings chart with gradient
0640:         const feelingsCtx = document.getElementById('feelingsChart').getContext('2d');
0641:         console.log("Creating feelings chart with data:", sampleData.dates, sampleData.feelings.values);
0642:         
0643:         // Create gradient for feelings chart
0644:         const feelingsGradient = feelingsCtx.createLinearGradient(0, 0, 0, 300);
0645:         feelingsGradient.addColorStop(0, 'rgba(0, 255, 0, 0.1)');
0646:         feelingsGradient.addColorStop(1, 'rgba(0, 255, 0, 0.0)');
0647:         
0648:         const feelingsConfig = {
0649:             type: 'line',
0650:             data: {
0651:                 labels: sampleData.dates,
0652:                 datasets: [{
0653:                     data: sampleData.feelings.values,
0654:                     borderColor: '#00FF00', // Green
0655:                     backgroundColor: feelingsGradient,
0656:                     borderWidth: 3,
0657:                     pointBackgroundColor: '#00FF00',
0658:                     pointBorderColor: '#00FF00',
0659:                     pointHoverBackgroundColor: '#00FF00',
0660:                     pointHoverBorderColor: '#00FF00',
0661:                     tension: 0.4,
0662:                     fill: true,
0663:                     spanGaps: true
0664:                 }]
0665:             },
0666:             options: {
0667:                 ...commonOptions,
0668:                 scales: {
0669:                     ...commonOptions.scales,
0670:                     y: {
0671:                         ...commonOptions.scales.y,
0672:                         min: 0,
0673:                         max: 10.5,
0674:                         ticks: {
0675:                             ...commonOptions.scales.y.ticks,
0676:                             stepSize: 2,
0677:                             color: '#000000',
0678:                             font: {
0679:                                 weight: 'bold'
0680:                             },
0681:                             callback: function(value) {
0682:                                 return value <= 10 ? value : '';
0683:                             }
0684:                         },
0685:                         title: {
0686:                             display: false,
0687:                             text: 'Самопочуття (1-10)',
0688:                             color: '#000000',
0689:                             font: {
0690:                                 weight: 'bold',
0691:                                 size: 14
0692:                             }
0693:                         },
0694:                         grid: {
0695:                             color: 'rgba(0, 0, 0, 0.1)'
0696:                         }
0697:                     },
0698:                     x: {
0699:                         grid: {
0700:                             display: false
0701:                         },
0702:                         ticks: {
0703:                             color: '#000000',
0704:                             font: {
0705:                                 weight: 'bold'
0706:                             }
0707:                         }
0708:                     }
0709:                 }
0710:             }
0711:         };
0712:         const feelingsChart = createChart(feelingsCtx, feelingsConfig, 'самопочуття');
0713: 
0714:         // Create weight chart with gradient
0715:         const weightCtx = document.getElementById('weightChart').getContext('2d');
0716:         
0717:         // Create gradient for weight chart
0718:         const weightGradient = weightCtx.createLinearGradient(0, 0, 0, 300);
0719:         weightGradient.addColorStop(0, 'rgba(0, 191, 255, 0.7)');
0720:         weightGradient.addColorStop(0.5, 'rgba(0, 191, 255, 0.3)');
0721:         weightGradient.addColorStop(1, 'rgba(0, 191, 255, 0.0)');
0722:         
0723:         if (sampleData.weight && sampleData.weight.values) {
0724:             console.log("Creating weight chart with data:", sampleData.dates, sampleData.weight.values);
0725:             const weightConfig = {
0726:                 type: 'line',
0727:                 data: {
0728:                     labels: sampleData.dates,
0729:                     datasets: [{
0730:                         data: sampleData.weight.values,
0731:                         borderColor: '#00BFFF', // Deep Sky Blue
0732:                         backgroundColor: weightGradient,
0733:                         borderWidth: 3,
0734:                         pointBackgroundColor: '#00BFFF',
0735:                         pointBorderColor: '#00BFFF',
0736:                         pointHoverBackgroundColor: '#00BFFF',
0737:                         pointHoverBorderColor: '#00BFFF',
0738:                         tension: 0.4,
0739:                         fill: true,
0740:                         spanGaps: true
0741:                     }]
0742:                 },
0743:                 options: {
0744:                     ...commonOptions,
0745:                     scales: {
0746:                         ...commonOptions.scales,
0747:                         y: {
0748:                             title: {
0749:                                 display: false,
0750:                                 text: 'Вага (кг)',
0751:                                 color: '#000000',
0752:                                 font: {
0753:                                     weight: 'bold',
0754:                                     size: 14
0755:                                 }
0756:                             },
0757:                             ticks: {
0758:                                 color: '#000000',
0759:                                 font: {
0760:                                     weight: 'bold'
0761:                                 }
0762:                             },
0763:                             grid: {
0764:                                 color: 'rgba(0, 0, 0, 0.1)'
0765:                             }
0766:                         },
0767:                         x: {
0768:                             grid: {
0769:                                 display: false
0770:                             },
0771:                             ticks: {
0772:                                 color: '#000000',
0773:                                 font: {
0774:                                     weight: 'bold'
0775:                                 }
0776:                             }
0777:                         }
0778:                     }
0779:                 }
0780:             };
0781:             const weightChart = createChart(weightCtx, weightConfig, 'вагу');
0782:         } else {
0783:             console.log("No weight data available");
0784:             // Display a message when no weight data is available
0785:             weightCtx.font = "16px Arial";
0786:             weightCtx.fillStyle = "#888";
0787:             weightCtx.textAlign = "center";
0788:             weightCtx.fillText("Немає даних про вагу", weightCtx.canvas.width/2, weightCtx.canvas.height/2);
0789:         }
0790:         
0791:         // Export functionality
0792:         document.getElementById('exportButton').addEventListener('click', function() {
0793:             // Create a mobile-friendly layout for export
0794:             createMobileImage();
0795:         });
0796:         
0797:         function createMobileImage() {
0798:             // Create a canvas for the mobile view
0799:             const mobileCanvas = document.createElement('canvas');
0800:             const ctx = mobileCanvas.getContext('2d');
0801:             
0802:             // Set canvas size for mobile (portrait orientation)
0803:             const width = 1080; // Standard mobile width
0804:             const height = 1920; // Taller height to fit all charts
0805:             mobileCanvas.width = width;
0806:             mobileCanvas.height = height;
0807:             
0808:             // Fill background
0809:             ctx.fillStyle = '#E6E9F0';
0810:             ctx.fillRect(0, 0, width, height);
0811:             
0812:             // Add title
0813:             ctx.fillStyle = '#000';
0814:             ctx.font = 'bold 40px Arial';
0815:             ctx.textAlign = 'center';
0816:             ctx.fillText(`Статистика тренувань - ${sampleData.user?.name || ""}`, width/2, 80);
0817:             
0818:             // Add period
0819:             ctx.font = '30px Arial';
0820:             ctx.fillText(`Період: ${sampleData.period?.start_date || ""} - ${sampleData.period?.end_date || ""}`, width/2, 130);
0821:             
0822:             // Add metrics
0823:             const metrics = [
0824:                 { label: 'Тренувань', value: sampleData.metrics?.trainings_count || 0 },
0825:                 { label: 'Середня складність', value: sampleData.metrics?.avg_hardness || 0 },
0826:                 { label: 'Середній стрес', value: sampleData.metrics?.avg_stress || 0 }
0827:             ];
0828:             
0829:             // Draw metrics box
0830:             const metricsBoxY = 160;
0831:             const metricsBoxHeight = 150;
0832:             drawRoundedRect(ctx, 50, metricsBoxY, width - 100, metricsBoxHeight, 20, '#FFFFFF');
0833:             
0834:             // Add metrics text
0835:             ctx.fillStyle = '#000';
0836:             const metricWidth = (width - 100) / 3;
0837:             metrics.forEach((metric, i) => {
0838:                 const x = 50 + (metricWidth * i) + (metricWidth / 2);
0839:                 ctx.font = 'bold 50px Arial';
0840:                 ctx.fillText(metric.value.toString(), x, metricsBoxY + 70);
0841:                 ctx.font = '25px Arial';
0842:                 ctx.fillText(metric.label, x, metricsBoxY + 110);
0843:             });
0844:             
0845:             // Chart dimensions
0846:             const chartWidth = width - 100;
0847:             const chartHeight = 300;
0848:             const chartSpacing = 30;
0849:             let currentY = metricsBoxY + metricsBoxHeight + 50;
0850:             
0851:             // Draw each chart
0852:             const charts = [
0853:                 { name: 'СТРЕС', canvas: document.getElementById('stressChart'), color: '#FFD700' },
0854:                 { name: 'СКЛАДНІСТЬ', canvas: document.getElementById('hardnessChart'), color: '#FF0000' },
0855:                 { name: 'СОН', canvas: document.getElementById('sleepChart'), color: '#9370DB' },
0856:                 { name: 'САМОПОЧУТТЯ', canvas: document.getElementById('feelingsChart'), color: '#00FF00' },
0857:                 { name: 'ВАГА', canvas: document.getElementById('weightChart'), color: '#00BFFF' }
0858:             ];
0859:             
0860:             charts.forEach(chart => {
0861:                 // Draw chart background
0862:                 drawRoundedRect(ctx, 50, currentY, chartWidth, chartHeight, 20, '#FFFFFF');
0863:                 
0864:                 // Draw chart title
0865:                 drawRoundedRect(ctx, width/2 - 150, currentY - 20, 300, 40, 20, chart.color);
0866:                 ctx.fillStyle = '#FFFFFF';
0867:                 ctx.font = 'bold 25px Arial';
0868:                 ctx.fillText(chart.name, width/2, currentY + 10);
0869:                 
0870:                 // Draw chart content
0871:                 if (chart.canvas) {
0872:                     ctx.drawImage(chart.canvas, 70, currentY + 30, chartWidth - 40, chartHeight - 60);
0873:                 }
0874:                 
0875:                 // Move to next chart position
0876:                 currentY += chartHeight + chartSpacing;
0877:             });
0878:             
0879:             // Convert canvas to image and download
0880:             const link = document.createElement('a');
0881:             link.download = `Статистика_${new Date().toISOString().split('T')[0]}.png`;
0882:             link.href = mobileCanvas.toDataURL('image/png');
0883:             link.click();
0884:         }
0885:         
0886:         // Helper function to draw rounded rectangles
0887:         function drawRoundedRect(ctx, x, y, width, height, radius, color) {
0888:             ctx.fillStyle = color;
0889:             ctx.beginPath();
0890:             ctx.moveTo(x + radius, y);
0891:             ctx.lineTo(x + width - radius, y);
0892:             ctx.quadraticCurveTo(x + width, y, x + width, y + radius);
0893:             ctx.lineTo(x + width, y + height - radius);
0894:             ctx.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);
0895:             ctx.lineTo(x + radius, y + height);
0896:             ctx.quadraticCurveTo(x, y + height, x, y + height - radius);
0897:             ctx.lineTo(x, y + radius);
0898:             ctx.quadraticCurveTo(x, y, x + radius, y);
0899:             ctx.closePath();
0900:             ctx.fill();
0901:             
0902:             // Add shadow effect
0903:             ctx.shadowColor = 'rgba(0, 0, 0, 0.1)';
0904:             ctx.shadowBlur = 10;
0905:             ctx.shadowOffsetX = 0;
0906:             ctx.shadowOffsetY = 5;
0907:             ctx.fill();
0908:             
0909:             // Reset shadow
0910:             ctx.shadowColor = 'transparent';
0911:             ctx.shadowBlur = 0;
0912:             ctx.shadowOffsetX = 0;
0913:             ctx.shadowOffsetY = 0;
0914:         }
0915:     </script>
0916: </body>
0917: </html>
